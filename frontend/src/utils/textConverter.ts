/**
 * 简繁体转换工具
 * 提供简体中文和繁体中文之间的转换功能
 */

// 简体到繁体映射表
// 注意：先映射词汇（较长），再映射字符（较短），避免词汇被拆分
const simplifiedToTraditional: Record<string, string> = {
  // ========== 常用词汇（优先映射，较长字符串） ==========
  // 学校相关词汇
  '结龙学校': '結龍學校',
  '直属中学': '直屬中學',
  '联系中学': '聯繫中學',
  '学校名称': '學校名稱',
  '学校类型': '學校類型',
  '学校类别': '學校類別',
  '学校组别': '學校組別',
  '学校信息': '學校信息',
  '学校面积': '學校面積',
  '学校地址': '學校地址',
  '开放申请': '開放申請',
  '申请截止': '申請截止',
  '即将截止': '即將截止',
  '正在加载': '正在加載',
  '加载失败': '加載失敗',
  '已加载全部': '已加載全部',
  '正在加载更多': '正在加載更多',
  '没有更多数据': '沒有更多數據',
  '名校联盟': '名校聯盟',
  '传统名校': '傳統名校',
  '直资学校': '直資學校',
  '官立学校': '官立學校',
  '私立学校': '私立學校',
  '资助学校': '資助學校',
  '联系小学': '聯繫小學',
  '联系大学': '聯繫大學',
  '升Band 1比例': '升Band 1比例',
  '教学语言': '教學語言',
  '总班数': '總班數',
  '学生人数': '學生人數',
  '教师人数': '教師人數',
  '建校年份': '建校年份',
  '课程设置': '課程設置',
  '插班信息': '插班信息',
  '升学信息': '升學信息',
  '评估信息': '評估信息',
  '班级教学信息': '班級教學信息',
  '总班数信息': '總班數信息',
  '基础信息': '基礎信息',
  '联系方式': '聯繫方式',
  '入学信息': '入學信息',
  '对应校网': '對應校網',
  
  // 界面操作词汇
  '取消选择': '取消選擇',
  '最后一页': '最後一頁',
  '第一页': '第一頁',
  '上一页': '上一頁',
  '下一页': '下一頁',
  '进行中': '進行中',
  
  // ========== 基础字符映射 ==========
  // 教育相关
  '学': '學',
  '教': '教',
  '师': '師',
  '课': '課',
  '程': '程',
  '级': '級',
  '资': '資',
  '馆': '館',
  '图': '圖',
  '体': '體',
  '训': '訓',
  '练': '練',
  '术': '術',
  '艺': '藝',
  '员': '員',
  '园': '園',
  '斋': '齋',
  '齐': '齊',
  '奖': '獎',
  '励': '勵',
  '优': '優',
  '胜': '勝',
  
  // 常用汉字
  '书': '書',
  '国': '國',
  '华': '華',
  '圣': '聖',
  '为': '為',
  '医': '醫',
  '会': '會',
  '义': '義',
  '宝': '寶',
  '协': '協',
  '庆': '慶',
  '铭': '銘',
  '贤': '賢',
  '纪': '紀',
  '刘': '劉',
  '张': '張',
  '陈': '陳',
  '杨': '楊',
  '黄': '黃',
  '赵': '趙',
  '郑': '鄭',
  '谢': '謝',
  '钟': '鍾',
  '陆': '陸',
  '余': '餘',
  '诸': '諸',
  '区': '區',
  '岳': '嶽',
  '乐': '樂',
  '蓝': '藍',
  '阎': '閻',
  '马': '馬',
  '卢': '盧',
  '蒋': '蔣',
  '苏': '蘇',
  '叶': '葉',
  '缘': '緣',
  '达': '達',
  '湾': '灣',
  '岛': '島',
  '门': '門',
  '东': '東',
  '贡': '貢',
  '护': '護',
  '谭': '譚',
  '邓': '鄧',
  '范': '範',
  '潘': '潘',
  '罗': '羅',
  '梁': '梁',
  '韦': '韋',
  '许': '許',
  '戴': '戴',
  '钱': '錢',
  '汤': '湯',
  '熊': '熊',
  '薛': '薛',
  '窦': '竇',
  '顾': '顧',
  '诺': '諾',
  '玛': '瑪',
  '丽': '麗',
  '启': '啟',
  '导': '導',
  '济': '濟',
  '卫': '衛',
  '坛': '壇',
  '侨': '僑',
  '乡': '鄉',
  '厦': '廈',
  '广': '廣',
  '汉': '漢',
  '台': '臺',
  '澳': '澳',
  '纠': '糾',
  '纷': '紛',
  
  // 宗教相关
  '灵': '靈',
  '爱': '愛',
  
  // 机构相关
  '社': '社',
  '团': '團',
  '联': '聯',
  '总': '總',
  '处': '處',
  '组': '組',
  '委': '委',
  '议': '議',
  '办': '辦',
  '业': '業',
  
  // 常用动词
  '来': '來',
  '还': '還',
  '进': '進',
  '运': '運',
  '关': '關',
  '开': '開',
  '闭': '閉',
  '从': '從',
  '应': '應',
  '当': '當',
  '对': '對',
  '与': '與',
  '给': '給',
  '让': '讓',
  '说': '說',
  '话': '話',
  '语': '語',
  '词': '詞',
  '认': '認',
  '识': '識',
  '读': '讀',
  '写': '寫',
  '听': '聽',
  '见': '見',
  '观': '觀',
  '闻': '聞',
  '问': '問',
  '答': '答',
  
  // 常用形容词
  '长': '長',
  '强': '強',
  '旧': '舊',
  '轻': '輕',
  '重': '重',
  '远': '遠',
  '近': '近',
  '贵': '貴',
  '贱': '賤',
  '劣': '劣',
  '专': '專',
  '实': '實',
  '际': '際',
  '现': '現',
  '过': '過',
  '历': '歷',
  '传': '傳',
  '统': '統',
  '继': '繼',
  '续': '續',
  '断': '斷',
  '连': '連',
  
  // 数量词
  '个': '個',
  '只': '隻',
  '双': '雙',
  '条': '條',
  '张': '張',
  '间': '間',
  '层': '層',
  '栋': '棟',
  '辆': '輛',
  
  // 香港特有（地名、街道）
  '径': '徑',
  '路': '路',
  '巷': '巷',
  '弄': '弄',
  '衞': '衛',  // 香港常用写法
  
  // 网络相关
  '网': '網',
  '络': '絡',
  '称': '稱',
  '属': '屬',
  '结': '結',
  '龙': '龍',
  
  // 其他常用字（基础字符，不重复）
  '校': '校',
  '小': '小',
  '中': '中',
  '生': '生',
  '名': '名',
  '地': '地',
  '直': '直',
  '等': '等',
  '费': '費',
  '止': '止',
  '比': '比',
  '例': '例',
  '示': '示',
  '隐': '隱',
  '展': '展',
  '收': '收',
  '选': '選',
  '择': '擇',
  '空': '空',
  '置': '置',
  '项': '項',
  '数': '數',
  '参': '參',
  '值': '值',
  '标': '標',
  '题': '題',
  '内': '內',
  '容': '容',
  '述': '述',
  '明': '明',
  '备': '備',
  '注': '註',
  '释': '釋',
  '签': '簽',
  '类': '類',
  '别': '別',
  '型': '型',
  '态': '態',
  '状': '狀',
  '度': '度',
  '成': '成',
  '暂': '暫',
  '停': '停',
  '始': '始',
  '束': '束',
  '时': '時',
  '日': '日',
  '期': '期',
  '份': '份',
  '星': '星',
  '分': '分',
  '秒': '秒',
  '毫': '毫',
  '今': '今',
  '昨': '昨',
  '天': '天',
  '上': '上',
  '下': '下',
  '月': '月',
  '年': '年',
  '去': '去',
  
  // 常用词汇（单字组合）
  '学校': '學校',
  '小学': '小學',
  '中学': '中學',
  '学生': '學生',
  '教师': '教師',
  '课程': '課程',
  '班级': '班級',
  '年级': '年級',
  '地区': '地區',
  '网络': '網絡',
  '联系': '聯繫',
  '直属': '直屬',
  '详情': '詳情',
  '学费': '學費',
  '截止': '截止',
  '搜索': '搜索',
  '名称': '名稱',
  '校网': '校網',
  '提示': '提示',
  '信息': '信息',
  '数据': '數據',
  '统计': '統計',
  '报告': '報告',
  '分析': '分析',
  '结果': '結果',
  '成功': '成功',
  '失败': '失敗',
  '错误': '錯誤',
  '警告': '警告',
  '确认': '確認',
  '取消': '取消',
  '保存': '保存',
  '删除': '刪除',
  '编辑': '編輯',
  '添加': '添加',
  '更新': '更新',
  '刷新': '刷新',
  '返回': '返回',
  '前进': '前進',
  '后退': '後退',
  '首页': '首頁',
  '页': '頁',
  '共': '共',
  '记录': '記錄',
  '显示': '顯示',
  '隐藏': '隱藏',
  '展开': '展開',
  '收起': '收起',
  '更多': '更多',
  '全部': '全部',
  '部分': '部分',
  '选择': '選擇',
  '全选': '全選',
  '清空': '清空',
  '重置': '重置',
  '提交': '提交',
  '发送': '發送',
  '接收': '接收',
  '下载': '下載',
  '上传': '上傳',
  '导入': '導入',
  '导出': '導出',
  '打印': '打印',
  '预览': '預覽',
  '查看': '查看',
  '设置': '設置',
  '配置': '配置',
  '选项': '選項',
  '参数': '參數',
  '标题': '標題',
  '内容': '內容',
  '描述': '描述',
  '说明': '說明',
  '备注': '備註',
  '注释': '註釋',
  '标签': '標籤',
  '分类': '分類',
  '类别': '類別',
  '类型': '類型',
  '状态': '狀態',
  '进度': '進度',
  '完成': '完成',
  '暂停': '暫停',
  '停止': '停止',
  '开始': '開始',
  '结束': '結束',
  '时间': '時間',
  '日期': '日期',
  '年份': '年份',
  '月份': '月份',
  '星期': '星期',
  '小时': '小時',
  '分钟': '分鐘',
  '今天': '今天',
  '昨天': '昨天',
  '明天': '明天',
  '本周': '本週',
  '上周': '上週',
  '下周': '下週',
  '本月': '本月',
  '上月': '上月',
  '下月': '下月',
  '今年': '今年',
  '去年': '去年',
  '明年': '明年',
  
  // 性别相关
  '男女校': '男女校',
  '男校': '男校',
  '女校': '女校',
  
  // 学校相关（基础，以上已定义，此处无需重复）
}

// 繁体到简体映射表（反向映射）
const traditionalToSimplified: Record<string, string> = {}
for (const key in simplifiedToTraditional) {
  const value = simplifiedToTraditional[key]
  // 只添加不重复的映射
  if (!(value in traditionalToSimplified)) {
    traditionalToSimplified[value] = key
  }
}

/**
 * 简体转繁体
 * @param text 简体中文文本
 * @returns 繁体中文文本
 */
export function simplifiedToTraditionalText(text: string): string {
  if (!text) return text
  
  // 先按长度排序，优先处理长词汇，避免词汇被拆分
  const entries: Array<[string, string]> = []
  for (const key in simplifiedToTraditional) {
    entries.push([key, simplifiedToTraditional[key]])
  }
  entries.sort(([a], [b]) => b.length - a.length)  // 按长度降序排列
  
  let result = text
  for (const [simplified, traditional] of entries) {
    // 使用全局替换，匹配完整单词（避免部分匹配）
    result = result.replace(new RegExp(simplified.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g'), traditional)
  }
  return result
}

/**
 * 繁体转简体
 * @param text 繁体中文文本
 * @returns 简体中文文本
 */
export function traditionalToSimplifiedText(text: string): string {
  if (!text) return text
  
  // 先按长度排序，优先处理长词汇
  const entries: Array<[string, string]> = []
  for (const key in traditionalToSimplified) {
    entries.push([key, traditionalToSimplified[key]])
  }
  entries.sort(([a], [b]) => b.length - a.length)  // 按长度降序排列
  
  let result = text
  for (const [traditional, simplified] of entries) {
    // 使用全局替换，转义正则表达式特殊字符
    const escaped = traditional.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')
    result = result.replace(new RegExp(escaped, 'g'), simplified)
  }
  return result
}

/**
 * 根据语言类型转换文本
 * @param text 原始文本
 * @param targetLanguage 目标语言
 * @returns 转换后的文本
 */
export function convertTextByLanguage(text: string, targetLanguage: 'zh-CN' | 'zh-TW'): string {
  if (!text) return text
  
  if (targetLanguage === 'zh-TW') {
    return simplifiedToTraditionalText(text)
  } else {
    return traditionalToSimplifiedText(text)
  }
}

/**
 * 检测文本是否为繁体中文
 * @param text 待检测的文本
 * @returns 是否为繁体中文
 */
export function isTraditionalChinese(text: string): boolean {
  if (!text) return false
  
  // 检查是否包含繁体字符
  for (const key in traditionalToSimplified) {
    if (text.indexOf(key) >= 0) {
      return true
    }
  }
  return false
}

/**
 * 检测文本是否为简体中文
 * @param text 待检测的文本
 * @returns 是否为简体中文
 */
export function isSimplifiedChinese(text: string): boolean {
  if (!text) return false
  
  // 检查是否包含简体字符
  for (const key in simplifiedToTraditional) {
    if (text.indexOf(key) >= 0) {
      return true
    }
  }
  return false
}
