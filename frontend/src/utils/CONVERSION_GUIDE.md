# 简繁体转换词库完善指南

## 已完成的工作

### 1. 词库结构优化
- ✅ 清理了重复的键（多个 '学': '學' 等）
- ✅ 按优先级组织：先长词汇，后短字符
- ✅ 参考后端词库，补充了常用字符映射

### 2. 转换函数优化
- ✅ 按长度排序，确保长词汇优先处理
- ✅ 转义正则表达式特殊字符，避免匹配错误
- ✅ 兼容 TypeScript（不使用 Object.entries）

### 3. 词库内容补充
已补充的类别：
- 教育相关字符（学、教、师、课等）
- 常用汉字（书、国、华、圣等）
- 人名常用字（刘、张、陈等）
- 机构相关（会、社、团等）
- 动词、形容词、数量词
- 香港特有字符（湾、岛、区等）
- 学校相关词汇（结龙学校、直属中学等）
- 界面操作词汇（正在加载、申请截止等）

## 如何继续完善词库

### 方法1：实际使用中发现
1. **运行应用**，切换到繁体中文
2. **观察界面**，找出未转换的字符
3. **添加到映射表**，按照以下格式：

```typescript
// 如果发现 "学校类型" 没有转换，添加：
'学校类型': '學校類型',

// 如果是单个字符，添加到字符映射部分：
'类': '類',  // 如果还没添加的话
```

### 方法2：系统化补充
根据以下类别逐一检查：

#### 1. 香港地名（可能需要）
- 各区名称：九龙、新界、港岛等
- 具体区域：屯门、沙田、观塘等

#### 2. 学校相关术语
- 课程体系：IB、DSE、AP等（英文缩写通常不转换）
- 评估方式：持续评估、测验、考试等
- 学校特色：全人教育、双语教学等

#### 3. 数据字段名称
检查后端返回的所有字段：
- `school_name` → 已处理（通过 nameTraditional）
- `district` → 需要转换
- `school_category` → 需要转换
- 其他 JSON 字段内的文本

#### 4. UI 文本
检查所有 i18n 翻译文件：
- `frontend/src/i18n/locales/zh-CN.ts`
- 确保所有简体文本都有对应的繁体映射

## 测试方法

### 手动测试
```typescript
// 在浏览器控制台测试
import { convertTextByLanguage } from '@/utils/textConverter'

// 测试学校相关
convertTextByLanguage('学校名称', 'zh-TW')  // 应该返回 '學校名稱'
convertTextByLanguage('联系中学', 'zh-TW')  // 应该返回 '聯繫中學'

// 测试界面文本
convertTextByLanguage('正在加载', 'zh-TW')  // 应该返回 '正在加載'
convertTextByLanguage('申请截止', 'zh-TW')  // 应该返回 '申請截止'
```

### 自动化测试建议
创建测试文件 `textConverter.test.ts`：
```typescript
import { convertTextByLanguage } from './textConverter'

describe('简繁体转换', () => {
  const testCases = [
    ['学校', '學校'],
    ['联系中学', '聯繫中學'],
    ['正在加载', '正在加載'],
    // 添加更多用例
  ]

  testCases.forEach(([simp, expected]) => {
    test(`${simp} 应该转换为 ${expected}`, () => {
      const result = convertTextByLanguage(simp, 'zh-TW')
      expect(result).toBe(expected)
    })
  })
})
```

## 维护注意事项

### 1. 避免重复
- 每个键只能出现一次
- 使用代码检查工具（如 ESLint）检测重复

### 2. 优先级
- **长词汇优先**：先添加多字词汇（如 '学校名称'），再添加单字（如 '学'）
- 转换函数已按长度排序，但最好在映射表中就按顺序组织

### 3. 特殊字符
- 注意转义正则表达式特殊字符（如 `.`, `*`, `+`, `?` 等）
- 转换函数已处理转义，但仍需注意

### 4. 一对多情况
- 一个简体字可能对应多个繁体字
- 使用最常见的繁体字
- 特殊情况可以通过词汇映射处理

## 常见问题

### Q: 为什么某些字符没有转换？
A: 可能原因：
1. 该字符在映射表中不存在
2. 该字符已经繁体，不需要转换
3. 转换顺序问题（短字符先转换，导致长词汇被拆分）

### Q: 如何处理英文混合文本？
A: 只转换中文字符，英文和数字保持不变：
```typescript
convertTextByLanguage('学校ABC123', 'zh-TW')  // '學校ABC123'
```

### Q: 如何添加新的映射？
A: 
1. 找到合适的位置（词汇放在前面，字符放在后面）
2. 按照格式添加：`'简体': '繁體',`
3. 注意末尾逗号
4. 测试验证

## 下一步建议

1. **运行应用并测试**，记录未转换的字符
2. **检查 i18n 文件**，确保所有界面文本都有映射
3. **检查后端数据**，确保字段名称正确转换
4. **创建测试用例**，防止回归
5. **定期更新**，根据用户反馈补充

