# 教学语言弹窗居中定位修复说明

## 问题描述

在 PC 端点击教学语言的 ℹ️ 图标后，弹窗虽然显示在字段下方，但是向右偏移超出了屏幕范围，导致：
- ❌ 弹窗部分内容在屏幕外，无法看到
- ❌ 页面出现横向滚动条
- ❌ 用户需要左右滚动才能看完整内容

## 问题原因

### 之前的定位方式
```css
.language-info-popup {
  position: absolute;
  top: 100%;
  left: 0;              /* ❌ 从左边缘开始 */
  min-width: 380px;     /* ❌ 固定最小宽度 */
}
```

### 为什么会超出？

**布局分析：**
```
.info-grid (两列布局)
├─ .info-item (第1列，宽度约 250px)
│   └─ .language-info-popup (left: 0, width: 380px)
│       └─ 380px > 250px → 超出右侧边界 120px ❌
└─ .info-item (第2列，宽度约 250px)
```

**视觉效果：**
```
┌─────────────────────────────────────┐
│ ┌──────────┐  ┌──────────┐         │
│ │教学语言 ℹ│  │其他字段  │         │
│ └──────────┘  └──────────┘         │
│ ┌────────────────────────────┐     │
│ │ 弹窗表格（380px宽）→→→→→  │超出→│
│ └────────────────────────────┘     │
└─────────────────────────────────────┘
                                  ↑
                            横向滚动条出现
```

## 解决方案

### 新的定位方式
```css
.language-info-popup {
  position: absolute;
  top: 100%;
  left: 50%;                          /* ✅ 从父元素中心点开始 */
  transform: translateX(-50%);        /* ✅ 向左偏移自身宽度的50% */
  margin-top: 8px;
  width: 420px;                       /* ✅ 固定宽度 */
  max-width: calc(100vw - 40px);      /* ✅ 限制不超出视口 */
}
```

### 定位原理

#### 水平居中
```
left: 50% 
    ↓
从父元素中点开始
    ↓
transform: translateX(-50%)
    ↓
向左偏移自身宽度的一半
    ↓
✅ 实现水平居中
```

#### 宽度控制
```
width: 420px
    ↓
首选宽度 420px
    ↓
max-width: calc(100vw - 40px)
    ↓
如果屏幕宽度不够，自动缩小
    ↓
✅ 永远不超出屏幕
```

## 修复效果

### 修复前
```
┌─────────────────────────────────────┐
│ ┌──────────┐  ┌──────────┐         │
│ │教学语言 ℹ│  │其他字段  │         │
│ └──────────┘  └──────────┘         │
│ ┌────────────────────────────┐     │
│ │         弹窗（超出）→→→→→  │超出→│
│ └────────────────────────────┘     │
└─────────────────────────────────────┘
❌ 弹窗右侧超出，出现横向滚动条
```

### 修复后
```
┌─────────────────────────────────────┐
│ ┌──────────┐  ┌──────────┐         │
│ │教学语言 ℹ│  │其他字段  │         │
│ └──────────┘  └──────────┘         │
│     ┌─────────────────────┐        │
│     │     弹窗（居中）    │        │
│     └─────────────────────┘        │
└─────────────────────────────────────┘
✅ 弹窗水平居中，不超出边界
```

## 技术细节

### CSS Transform 居中法

#### 传统方法（可能超出）
```css
left: 0;
width: 400px;  /* 可能超出父元素 */
```

#### 居中方法（推荐）✅
```css
left: 50%;
transform: translateX(-50%);
width: 420px;
```

#### 计算示例
```
假设 info-item 宽度 = 250px
弹窗宽度 = 420px

left: 50%
→ 弹窗左边缘距离 info-item 左边缘 = 250px * 50% = 125px

transform: translateX(-50%)
→ 弹窗向左移动自身宽度的 50% = 420px * 50% = 210px

最终位置：
弹窗左边缘 = 125px - 210px = -85px（超出 info-item 左侧）
弹窗右边缘 = -85px + 420px = 335px（超出 info-item 右侧）

但因为居中，所以在视觉上是平衡的
```

### 防止超出视口

```css
max-width: calc(100vw - 40px);
```

**说明：**
- `100vw` = 视口宽度（浏览器窗口宽度）
- `- 40px` = 左右各留 20px 边距
- 如果 420px 超出，自动缩小到 `100vw - 40px`

**示例：**
```
窄屏幕（500px）：
  弹窗宽度 = min(420px, 500px - 40px) = 460px
  实际使用 = 460px（缩小了）

宽屏幕（1200px）：
  弹窗宽度 = min(420px, 1200px - 40px) = 420px
  实际使用 = 420px（保持原宽度）
```

## 响应式行为

### PC 端 / 平板（> 480px）
```css
.language-info-popup {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  width: 420px;
  max-width: calc(100vw - 40px);
}
```
✅ 相对于 info-item 水平居中，不超出视口

### 手机端（≤ 480px）
```css
@media (max-width: 480px) {
  .language-info-popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;
    max-width: 400px;
  }
}
```
✅ 相对于屏幕居中

## 不同场景测试

### 场景1：宽屏桌面（1920px）
```
弹窗宽度 = 420px
居中显示，左右都有充足空间 ✅
```

### 场景2：笔记本（1440px）
```
弹窗宽度 = 420px
居中显示，不超出 ✅
```

### 场景3：小笔记本（1024px）
```
弹窗宽度 = 420px
居中显示，可能略微超出 info-grid，但不超出视口 ✅
```

### 场景4：平板竖屏（768px）
```
弹窗宽度 = min(420px, 768px - 40px) = 420px
居中显示 ✅
```

### 场景5：窄窗口（600px）
```
弹窗宽度 = min(420px, 600px - 40px) = 560px
实际使用 = 560px（缩小了）
居中显示 ✅
```

## 修复的关键点

### 1. 水平居中
```css
left: 50%;              /* 从中心点开始 */
transform: translateX(-50%);  /* 向左偏移50% */
```

### 2. 智能宽度
```css
width: 420px;                  /* 首选宽度 */
max-width: calc(100vw - 40px); /* 不超出视口 */
```

### 3. 高 z-index
```css
z-index: 1000;  /* 确保在最上层 */
```

## 溢出控制对比

### 方法A：限制在父元素内（旧方案）
```css
left: 0;
right: 0;
```
- ❌ 宽度受限于父元素
- ❌ 表格可能显示不完整

### 方法B：固定宽度从左侧（问题方案）
```css
left: 0;
min-width: 380px;
```
- ❌ 超出右侧边界
- ❌ 出现横向滚动条

### 方法C：居中显示（当前方案）✅
```css
left: 50%;
transform: translateX(-50%);
width: 420px;
max-width: calc(100vw - 40px);
```
- ✅ 水平居中，平衡美观
- ✅ 不超出视口
- ✅ 自适应缩小

## 视觉效果

### 弹窗在 info-item 下方居中显示
```
        info-item (约 250px)
     ┌─────────────────┐
     │   教学语言 ℹ️    │
     │   中英文并重     │
     └─────────────────┘
            ↓
    ┌───────────────────────┐
    │   教学语言分类标准     │← 420px，居中
    ├───────────────────────┤
    │ ┏━━━━━━━━━━━━━━━━━┓ │
    │ ┃ 表格内容...     ┃ │
    │ ┗━━━━━━━━━━━━━━━━━┛ │
    └───────────────────────┘
    ↑                       ↑
  左侧超出              右侧超出
  但不超出视口          但不超出视口
```

## 相关修改

**修改的文件：**
- `frontend/src/components/SchoolDetailModal.vue`

**CSS 修改：**
```diff
.language-info-popup {
  position: absolute;
  top: 100%;
- left: 0;
+ left: 50%;
+ transform: translateX(-50%);
- min-width: 380px;
- max-width: 500px;
+ width: 420px;
+ max-width: calc(100vw - 40px);
}
```

## 总结

此次修复通过使用 `left: 50%` + `transform: translateX(-50%)` 实现了弹窗的水平居中定位，配合 `max-width: calc(100vw - 40px)` 确保弹窗永远不会超出视口范围。

**修复后的效果：**
- ✅ 弹窗水平居中，美观平衡
- ✅ 不会超出屏幕右侧
- ✅ 不会出现横向滚动条
- ✅ 窄屏幕自动缩小宽度
- ✅ 宽屏幕保持固定宽度

现在在 PC 端点击教学语言的 ℹ️ 图标，弹窗会正确地在字段下方居中显示，不会超出屏幕范围！✨

