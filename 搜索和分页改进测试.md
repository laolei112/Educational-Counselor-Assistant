# 搜索和分页改进测试指南

## 🎯 改进内容

### 1. 修复搜索后切换分页页码不变的问题
- **问题**：搜索后点击分页，页码没有变化
- **解决方案**：修改 `goToPage` 方法，正确传递页码参数给搜索和获取列表方法

### 2. 将每页显示个数选择器移到页面底部
- **问题**：每页显示个数选择器在结果统计区域，位置不够明显
- **解决方案**：将选择器移到分页组件下方，独立显示

### 3. 优化搜索结果排序
- **问题**：搜索结果没有优先级排序
- **解决方案**：使用 Django 的 Case/When 实现智能排序

## 🧪 测试步骤

### 测试 1: 搜索后分页功能
1. 访问 `http://localhost/`
2. 在搜索框输入关键词（如"圣保罗"）
3. 等待搜索结果加载
4. 点击第2页按钮
5. **预期结果**：页码应该变为2，显示第2页的搜索结果
6. 点击第3页按钮
7. **预期结果**：页码应该变为3，显示第3页的搜索结果

### 测试 2: 页面大小选择器位置
1. 访问 `http://localhost/`
2. 滚动到页面底部
3. **预期结果**：在分页组件下方应该看到"每页显示"选择器
4. 尝试更改每页显示数量（如从20改为10）
5. **预期结果**：页面应该重新加载，每页显示10条记录

### 测试 3: 搜索结果排序
1. 访问 `http://localhost/search-test`
2. 搜索"圣保罗"
3. **预期结果**：校名包含"圣保罗"的学校应该排在最前面
4. 搜索"中西区"
5. **预期结果**：校名包含"中西区"的学校应该排在最前面，其次是地区包含"中西区"的学校

### 测试 4: 实时搜索功能
1. 访问 `http://localhost/`
2. 在搜索框中输入"精英"
3. **预期结果**：输入后500ms自动搜索，不需要点击搜索按钮
4. 清空搜索框
5. **预期结果**：应该自动显示所有学校

### 测试 5: 分页状态保持
1. 搜索"直资"
2. 点击第2页
3. 切换到"小学"类型
4. **预期结果**：应该显示小学的搜索结果，页码重置为1
5. 切换回"中学"类型
6. **预期结果**：应该显示中学的搜索结果，页码重置为1

## 🔍 调试信息

### 前端控制台日志
打开浏览器开发者工具，查看控制台输出：
- `🔄 翻页到第 X 页` - 翻页操作
- `🔍 搜索模式：搜索关键词 "XXX"` - 搜索模式
- `📋 列表模式：获取学校列表` - 列表模式
- `📡 API 查询参数` - API请求参数
- `✅ API 响应成功` - API响应成功

### 后端日志
```bash
# 查看后端日志
docker-compose logs -f backend
```

## 📊 排序优先级

搜索结果按以下优先级排序：

1. **校名包含关键词** - 优先级最高
2. **地区包含关键词**
3. **地址包含关键词**
4. **分类包含关键词**
5. **宗教包含关键词**
6. **校网包含关键词**
7. **备注包含关键词**
8. **其他匹配** - 优先级最低

## 🐛 常见问题

### Q: 搜索后分页还是有问题？
A: 检查控制台日志，确认 `goToPage` 方法是否正确传递了页码参数

### Q: 页面大小选择器看不到？
A: 确保滚动到页面最底部，选择器在分页组件下方

### Q: 搜索结果排序不正确？
A: 检查后端日志，确认数据库查询是否正确执行了排序

### Q: 实时搜索不工作？
A: 检查 `handleSearchInput` 方法是否正确绑定到输入框的 `@input` 事件

## ✅ 验收标准

- [ ] 搜索后分页功能正常
- [ ] 页面大小选择器位置正确
- [ ] 搜索结果按优先级排序
- [ ] 实时搜索功能正常
- [ ] 分页状态正确保持
- [ ] 移动端响应式正常
- [ ] 控制台无错误信息

## 🚀 性能优化

- 搜索结果使用数据库排序，避免前端排序
- 分页参数正确传递，减少不必要的API调用
- 实时搜索使用防抖，避免频繁请求
- 移动端样式优化，提升用户体验
